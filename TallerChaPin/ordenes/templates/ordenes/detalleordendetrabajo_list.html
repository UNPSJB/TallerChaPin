{% extends 'template_ordenes.html' %} {% load static %} {% block extracss %}
<link rel="stylesheet" href="{% static 'libs/bootstrap/css/sidebars.css' %}" />
<link rel="stylesheet" href="{% static 'ordenes/css/detalles-orden.css' %}" />
<link rel="stylesheet" href="{% static 'css/navbar.css' %}" />
{% endblock %} {% load crispy_forms_tags %} {% block title %} {{titulo}} {%endblock %} 

{% block main %}
<h1>{{titulo}}</h1>
<hr>
<div class="contenedor d-flex">
  <div class="btn-group filtros" role="group" aria-label="Basic example">
    <button type="button" class="btn btn-primary">Detalles sin asignar</button>
    <button type="button" class="btn btn-primary">Detalles sin terminar</button>
    <button type="button" class="btn btn-primary">Detalles terminados</button>
    <button type="button" class="btn btn-primary">Ver todos</button>
  </div>
</div>

<div class="row row-cols-1 row-cols-md-3 g-4 tablero mb-5">
  {% for detalle_orden in object_list %}
    <div class="col">
      <div class="card shadow-lg">

        {% if detalle_orden.esta_sin_iniciar %}
          <div class="card-header text-light bg-danger"><i class="fas fa-times"></i> Sin iniciar</div>
        {% elif detalle_orden.esta_en_proceso %}
          <div class="card-header text-light bg-primary"><i class="fas fa-tools"></i> En proceso</div>
        {% elif detalle_orden.esta_finalizado and detalle_orden.exitosa %}
          <div class="card-header text-light bg-success"><i class="fas fa-check"></i> Finalizado correctamente</div>
        {% elif detalle_orden.esta_finalizado and not detalle_orden.exitosa %}
          <div class="card-header text-light bg-warning"><i class="fas fa-check"></i> Finalizado no correctamente</div>
        {% endif %}

        <div class="card-body">
          <h5 class="card-title">{{detalle_orden.tarea}}</h5>
          {% if detalle_orden.observaciones != None %}
            <p class="card-text">{{detalle_orden.observaciones}}</p>
          {% endif %}
        </div>
        <ul class="list-group list-group-flush">
          
          <li class="list-group-item">
            <i class="fas fa-user"></i> 
            {% if detalle_orden.empleado != None %}
              {{detalle_orden.empleado}}
            {% else %}
              Sin asignar
            {% endif %}
          </li>

          <li class="list-group-item">
            Inicio: 
            {% if detalle_orden.inicio != None %}
              {{detalle_orden.inicio}}
            {% else %}
              Sin comenzar
            {% endif %}
          </li>

          <li class="list-group-item">
            Fin: 
            {% if detalle_orden.fin != None %}
              {{detalle_orden.fin}}
            {% else %}
              Sin terminar
            {% endif %}
          </li>

          <li class="list-group-item text-center">

            {% if perms.ordenes.can_asignar_trabajo and detalle_orden.puedo_asignar %}
              <a href="#" class="btn btn-primary">
                <i class="fas fa-user-plus"></i> Asignar
              </a>
            {% endif %}

            {% if detalle_orden.empleado != None %}
              {% if detalle_orden.puedo_iniciar %}
                <a href="#" class="btn btn-success">
                  <i class="fas fa-times"></i> Comenzar
                </a>
              {% endif %}

              {% if detalle_orden.puedo_finalizar %}
                <a href="#" class="btn btn-success">
                  <i class="fas fa-check"></i> Finalizar
                </a>
                <a href="#" class="btn btn-danger">
                  <i class="fas fa-times"></i> Finalizar mal
                </a>
              {% endif %}
            {% endif %}
          </li>
        </ul>
      </div>
    </div>
  {%endfor%}
</div>

{% endblock %}
